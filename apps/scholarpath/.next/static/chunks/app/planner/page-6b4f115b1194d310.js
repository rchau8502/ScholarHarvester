(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{3583:(e,t,a)=>{Promise.resolve().then(a.bind(a,1579))},1579:(e,t,a)=>{"use strict";a.d(t,{PlannerView:()=>o});var l=a(7437),s=a(2265),r=a(8464),n=a(8935);function i(e){let{open:t,onClose:a,metrics:r,provenance:n}=e,i=(0,s.useMemo)(()=>0===r.length?null:r.reduce((e,t)=>Math.min(e,t.metric_year),r[0].metric_year),[r]),c=null!==i&&i<new Date().getFullYear()-3;return(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 transition-opacity ".concat(t?"opacity-100":"pointer-events-none opacity-0"),role:"dialog","aria-modal":"true",children:(0,l.jsxs)("div",{className:"absolute right-0 top-0 h-full w-full max-w-xl transform bg-white p-6 shadow-xl transition-transform ".concat(t?"translate-x-0":"translate-x-full"),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-primary",children:"Evidence Drawer"}),(0,l.jsx)("button",{onClick:a,className:"rounded border border-slate-300 px-3 py-1 text-sm",children:"Close"})]}),c&&(0,l.jsx)("div",{className:"mt-4 rounded bg-yellow-100 p-3 text-sm text-yellow-900",children:"Some evidence is older than three years. Verify with the campus before relying on it."}),(0,l.jsx)("div",{className:"mt-4 space-y-3 overflow-y-auto text-sm",children:r.map(e=>{var t,a;return(0,l.jsxs)("div",{className:"rounded border border-slate-200 p-3",children:[(0,l.jsxs)("div",{className:"font-semibold text-slate-700",children:[e.metric_key," \xb7 ",e.metric_year]}),(0,l.jsxs)("div",{className:"text-slate-600",children:["Value: ",null!==(a=null!==(t=e.value_float)&&void 0!==t?t:e.value_text)&&void 0!==a?a:"N/A"]}),(0,l.jsxs)("div",{className:"mt-2 text-xs text-slate-500",children:["Source: ",(0,l.jsx)("a",{className:"text-primary underline",href:e.citation_url,target:"_blank",rel:"noreferrer",children:e.citation_title})]})]},"".concat(e.metric_key,"-").concat(e.metric_year))})}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-slate-500",children:"Citations"}),(0,l.jsx)("ul",{className:"mt-2 space-y-2 text-xs text-slate-500",children:n.map(e=>(0,l.jsxs)("li",{children:[(0,l.jsx)("span",{className:"font-semibold text-slate-600",children:e.metric_key})," — ",e.citation_title," (",e.publication_year,") \xb7"," ",(0,l.jsx)("a",{className:"text-primary underline",href:e.url,target:"_blank",rel:"noreferrer",children:e.publisher})," ","– ",e.interpretation_note]},"".concat(e.metric_key,"-").concat(e.publication_year)))})]})]})})}let c=["gpa_p25","gpa_p50","gpa_p75"];function o(){var e;let{data:t}=(0,n.w)("campuses",()=>(0,r.Au)()),[a,o]=(0,s.useState)(),[m,u]=(0,s.useState)(),{data:x}=(0,n.w)(a?"profile:".concat(a):null,()=>(0,r.gy)(a),[a]),{data:p}=(0,n.w)("provenance",()=>(0,r.oV)()),[h,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{!a&&t&&t.length>0&&o(t[0].slug)},[t,a]);let f=null!==(e=null==x?void 0:x.metrics)&&void 0!==e?e:[],y=(0,s.useMemo)(()=>Array.from(new Set(f.map(e=>e.metric_year))).sort((e,t)=>t-e),[f]);(0,s.useEffect)(()=>{!m&&y.length>0&&u(y[0])},[y,m]);let _=f.filter(e=>!m||e.metric_year===m),g=c.map(e=>_.find(t=>t.metric_key===e)),b=_.find(e=>"admit_rate"===e.metric_key);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium",children:"Campus"}),(0,l.jsx)("select",{className:"rounded border border-slate-300 px-3 py-2",value:a,onChange:e=>o(e.target.value),children:null==t?void 0:t.map(e=>(0,l.jsx)("option",{value:e.slug,children:e.name},e.slug))})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Year"}),(0,l.jsx)("div",{className:"flex gap-2",children:y.map(e=>(0,l.jsx)("button",{className:"rounded-full border px-3 py-1 text-sm ".concat(m===e?"bg-primary text-white":"border-slate-300 text-slate-600"),onClick:()=>u(e),children:e},e))})]}),(0,l.jsx)("button",{className:"ml-auto rounded bg-accent px-4 py-2 text-white",onClick:()=>v(!0),children:"Open Evidence"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[(0,l.jsx)(d,{title:"Admit Rate",value:(null==b?void 0:b.value_float)?"".concat(Math.round(100*b.value_float),"%"):"N/A"}),g.map((e,t)=>{var a,s;return(0,l.jsx)(d,{title:c[t].toUpperCase(),value:null!==(s=null==e?void 0:null===(a=e.value_float)||void 0===a?void 0:a.toFixed(2))&&void 0!==s?s:"N/A"},c[t])})]}),(0,l.jsx)(i,{open:h,onClose:()=>v(!1),metrics:_,provenance:null!=p?p:[]})]})}function d(e){let{title:t,value:a}=e;return(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-500",children:t}),(0,l.jsx)("p",{className:"text-2xl font-semibold text-primary",children:a})]})}},8464:(e,t,a)=>{"use strict";a.d(t,{Au:()=>r,Kt:()=>n,gy:()=>i,oV:()=>c});let l=a(8023).env.NEXT_PUBLIC_API_URL||"http://localhost:8080";async function s(e){let t=await fetch("".concat(l).concat(e),{cache:"no-store"});if(!t.ok)throw Error("Failed to fetch ".concat(e));return t.json()}async function r(){return s("/v1/campuses")}async function n(e){let t=new URLSearchParams;e.campus&&t.set("campus",e.campus),e.metric_key&&t.set("metric_key",e.metric_key);let a=t.toString();return s("/v1/metrics".concat(a?"?".concat(a):""))}async function i(e){return s("/v1/profile/".concat(e))}async function c(){return s("/v1/provenance")}},8935:(e,t,a)=>{"use strict";a.d(t,{w:()=>s});var l=a(2265);function s(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[s,r]=(0,l.useState)({loading:!!e});return(0,l.useEffect)(()=>{let a=!1;return e?(r(e=>({...e,loading:!0,error:void 0})),t().then(e=>{a||r({data:e,loading:!1})}).catch(e=>{a||r({error:e,loading:!1})})):r({data:void 0,loading:!1}),()=>{a=!0}},[e,...a]),s}}},e=>{var t=t=>e(e.s=t);e.O(0,[130,182,744],()=>t(3583)),_N_E=e.O()}]);